<!DOCTYPE html>
<html>
  <head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1">

    <link rel="Shortcut Icon" type="image/x-icon" href="images/ico/Dapino-Summer-Holiday-Palm-tree.ico">
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.0.0-beta1/dist/css/bootstrap.min.css" rel="stylesheet" integrity="sha384-giJF6kkoqNQ00vy+HMDP7azOuL0xtbfIcaT9wjKHr8RbDVddVHyTfAAsrekwKmP1" crossorigin="anonymous">
    <title>居家空氣盒子</title>
    
    <style>
      /*body
      {
        background-color: Gray;
      }*/

      /*居家空氣盒子的樣式*/
      #boxheader
      {
        height: 110px;
        background: #FFFFFF;
        margin: 0 auto;
        color: #bcab9f;
        font-size: 7vmin;
        border-top:5px;
        border-right:0px;
        border-left:0px;
        border-bottom:5px;
        border-style:solid;
        border-color:#bcab9f;
        text-align:center;
        line-height: 100px;
      }

      /*即時數值樣式與切版*/
      .row
      {
        padding-left:12px;
        padding-right:12px;
      }
      section
      {
        background-color: #d4c0b3;
        height: 760px;
        width: 100%;
        overflow-y: auto;
        -webkit-overflow-scrolling: touch;
        -ms-overflow-style: -ms-autohiding-scrollbar;
        /*border-top:0px;
        border-right:0px;
        border-left:0px;
        border-bottom:5px;
        border-style:solid;
        border-color:#bcab9f;*/
      }

      .immediately
      {
        height: 80px;
        line-height:80px;
        background: #d4c0b3;
        margin: 0 auto;
        font-size: 3.8vh;
        color: #FFFFFF;  
        text-align:center;  
      }

      .css-table-im{
        display: table;
      }
      .css-table-im .tbody{
        display:table-row-group;
      }
      .css-table-im .tr{
        display:table-row;
      }
      .css-table-im .td{
        display:table-cell;
        height: 170px;
        line-height:150px;
        font-size: 30px;
        text-align:center;
        width: 300px;
      } 

      /*下拉式選單排版與樣式*/
      nav
      {
        /*margin-left: -12px;*/
        border-top:0px;
        border-right:0px;
        border-left:0px;
        border-bottom:1px;
        /* border-radius: 70px; */
        border-style:solid;
        border-color:#bcab9f;
        height: 80px;
      }

      #droplist
      {
        height: 100px;
        line-height: 80px;
        background: #FFFFFF;
        margin: 0 auto;
        color: #bcab9f;
        text-align:center;
        font-size: 3.8vh;
      }

      /*歷史數據切版與樣式*/
      aside
      {
        height: 660px;
        /*border-top:0px;
        border-right:0px;
        border-left:0px;
        border-bottom:5px;
        border-style:solid;
        border-color:#bcab9f;*/
        float: left;
      }

      .css-table{
        display: table;
      }
      .css-table .tbody{
        display:table-row-group;
      }
      .css-table .tr{
        display:table-row;
        /*width: ;*/
        height: 80px;
        line-height:80px;
        font-size: 30px;
        text-align:center;
        align-items: left;
      }
      .css-table .tr2{
        display:table-row;
        /*width: ;*/
        /*height: 100px;*/
        line-height:0px;
        font-size: 10px;
        /*letter-spacing:3px;*/
        text-align:center;
        /*align-items: left;*/
      }
      .css-table .td{
        display:table-cell;
        width: 684px;
      }

      #msg, #msg2, #msg3
      {
        font-size: 20px;
      }


      footer
      {
        height: 50px;
        line-height:50px;
        text-align:center;
        color: #adadb0;
      }

    </style>

    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.0.0-beta1/dist/css/bootstrap.min.css" rel="stylesheet" integrity="sha384-giJF6kkoqNQ00vy+HMDP7azOuL0xtbfIcaT9wjKHr8RbDVddVHyTfAAsrekwKmP1" crossorigin="anonymous">
  </head>

  <body>
    <script src="https://cdn.jsdelivr.net/npm/@popperjs/core@2.5.4/dist/umd/popper.min.js" integrity="sha384-q2kxQ16AaE6UbzuKqyBE9/u/KzioAlnx2maXQHiDX9d4/zp8Ok3f+M7DPm+Ib6IU" crossorigin="anonymous"></script>
    <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.0.0-beta1/dist/js/bootstrap.min.js" integrity="sha384-pQQkAEnwaBkjpqZ8RU1fF1AKtTcHJwFl3pblpTlHXybJjHpMYo79HY3hIi4NKxyj" crossorigin="anonymous"></script>

    <div class="container-fluid">
      <header>
        <div id="boxheader" >
          <p>居家空氣盒子</p>
        </div>
      </header> 
      <div class="row">
        <section class="col-lg-6 col-md-6 col-sm-12 col-xs-12">
          <div class="immediately">
            <p>即時數值</p>
          </div>
          <div class="d-grid gap-2">
            <button type="button" class="btn btn-outline-light" onclick="loadDoc()">Cherry's room</button>
            <button type="button" class="btn btn-outline-light" onclick="loadDoc2()">LuLu's room</button>
            <button type="button" class="btn btn-outline-light" onclick="loadDoc3()">Red's room</button>
            <button type="button" class="btn btn-outline-light" onclick="loadDoc4()">Angel's room</button>  
            <button type="button" class="btn btn-outline-light" onclick="loadDoc5()">Irene's room</button>
          </div>
          <p id="demo"></p>
          <script>
          function loadDoc() {
            var xhttp = new XMLHttpRequest();
            xhttp.onreadystatechange = function() {
              if (this.readyState == 4 && this.status == 200) {
                ds = this.responseText.split(",");
                //ds[0];
                ds[0].split(" ");
                dd = ds[0].split(" ");
                document.getElementById("text1").innerHTML = [dd[3]];
                document.getElementById("path1").setAttribute("stroke-dasharray",dd[3].slice(0,5).concat(' 100')) ;
                document.getElementById("text2").innerHTML = [dd[4]];
                document.getElementById("path2").setAttribute("stroke-dasharray",dd[4].slice(0,5).concat(' 100')) ;
                document.getElementById("text3").innerHTML = [dd[5]];
                document.getElementById("path3").setAttribute("stroke-dasharray",dd[5].slice(0,5).concat(' 100')) ;
                // document.getElementById("text1").innerHTML = ["溫度:",dd[3],"濕度：",dd[4],"濕度：",dd[5]];
              }    
            };
            xhttp.open("GET", "http://192.168.43.211/cherry.php", true);
            //xhttp.setRequestHeader( "Access-Control-Allow-Origin" ,"*" );
            xhttp.send();
          }
          //ds[0].split(" ")
          //dd = ds[0].split(" ")
          //dd[3], dd[4],dd[5]
          
          function loadDoc2() {
            var xhttp = new XMLHttpRequest();
            xhttp.onreadystatechange = function() {
              if (this.readyState == 4 && this.status == 200) {
                ds = this.responseText.split(",");
                //ds[0];
                ds[0].split(" ");
                dd = ds[0].split(" ");
                document.getElementById("text1").innerHTML = [dd[3]];
                document.getElementById("path1").setAttribute("stroke-dasharray",dd[3].slice(0,5).concat(' 100')) ;
                document.getElementById("text2").innerHTML = [dd[4]];
                document.getElementById("path2").setAttribute("stroke-dasharray",dd[4].slice(0,5).concat(' 100')) ;
                document.getElementById("text3").innerHTML = [dd[5]];
                document.getElementById("path3").setAttribute("stroke-dasharray",dd[5].slice(0,5).concat(' 100')) ;
                // document.getElementById("demo").innerHTML = ["溫度:",dd[3],"濕度：",dd[4],"濕度：",dd[5]];
              }    
            };
            xhttp.open("GET", "http://192.168.43.211/lulu.php", true);
            //xhttp.setRequestHeader( "Access-Control-Allow-Origin" ,"*" );
            xhttp.send();
          }
          
          function loadDoc3() {
            var xhttp = new XMLHttpRequest();
            xhttp.onreadystatechange = function() {
              if (this.readyState == 4 && this.status == 200) {
                ds = this.responseText.split(",");
                //ds[0];
                ds[0].split(" ");
                dd = ds[0].split(" ");
                document.getElementById("text1").innerHTML = [dd[3]];
                document.getElementById("path1").setAttribute("stroke-dasharray",dd[3].slice(0,5).concat(' 100')) ;
                document.getElementById("text2").innerHTML = [dd[4]];
                document.getElementById("path2").setAttribute("stroke-dasharray",dd[4].slice(0,5).concat(' 100')) ;
                document.getElementById("text3").innerHTML = [dd[5]];
                document.getElementById("path3").setAttribute("stroke-dasharray",dd[5].slice(0,5).concat(' 100')) ;
                // document.getElementById("demo").innerHTML = ["溫度:",dd[3],"濕度：",dd[4],"濕度：",dd[5]];
              }    
            };
            xhttp.open("GET", "http://192.168.43.211/red.php", true);
            //xhttp.setRequestHeader( "Access-Control-Allow-Origin" ,"*" );
            xhttp.send();
          }

          function loadDoc4() {
            var xhttp = new XMLHttpRequest();
            xhttp.onreadystatechange = function() {
              if (this.readyState == 4 && this.status == 200) {
                ds = this.responseText.split(",");
                //ds[0];
                ds[0].split(" ");
                dd = ds[0].split(" ");
                document.getElementById("text1").innerHTML = [dd[3]];
                document.getElementById("path1").setAttribute("stroke-dasharray",dd[3].slice(0,5).concat(' 100')) ;
                document.getElementById("text2").innerHTML = [dd[4]];
                document.getElementById("path2").setAttribute("stroke-dasharray",dd[4].slice(0,5).concat(' 100')) ;
                document.getElementById("text3").innerHTML = [dd[5]];
                document.getElementById("path3").setAttribute("stroke-dasharray",dd[5].slice(0,5).concat(' 100')) ;
                // document.getElementById("demo").innerHTML = ["溫度:",dd[3],"濕度：",dd[4],"濕度：",dd[5]];
              }    
            };
            xhttp.open("GET", "http://192.168.43.211/angel.php", true);
            //xhttp.setRequestHeader( "Access-Control-Allow-Origin" ,"*" );
            xhttp.send();
          }

          function loadDoc5() {
            var xhttp = new XMLHttpRequest();
            xhttp.onreadystatechange = function() {
              if (this.readyState == 4 && this.status == 200) {
                ds = this.responseText.split(",");
                //ds[0];
                ds[0].split(" ");
                dd = ds[0].split(" ");
                document.getElementById("text1").innerHTML = [dd[3]];
                document.getElementById("path1").setAttribute("stroke-dasharray",dd[3].slice(0,5).concat(' 100')) ;
                document.getElementById("text2").innerHTML = [dd[4]];
                document.getElementById("path2").setAttribute("stroke-dasharray",dd[4].slice(0,5).concat(' 100')) ;
                document.getElementById("text3").innerHTML = [dd[5]];
                document.getElementById("path3").setAttribute("stroke-dasharray",(dd[5]/'10').slice(0,5).concat(' 100')) ;
                // document.getElementById("demo").innerHTML = ["溫度:",dd[3],"濕度：",dd[4],"濕度：",dd[5]];
              }    
            };
            xhttp.open("GET", "http://192.168.43.211/irene.php", true);
            //xhttp.setRequestHeader( "Access-Control-Allow-Origin" ,"*" );
            xhttp.send();
          }


          </script>
          
          
          <div style="height: 20px"></div>
          <div id="css-table-im" class="css-table-im">
            <div class="tbody">
              <div class="tr">
                <div class="td">溫度</div>
                <div class="td">
                  <svg  xmlns='http://www.w3.org/2000/svg' viewBox='-2 -2 50 42' width='150' height='126'>
                  <path d='M10 37 a20 20 0 1 1 24 0'  stroke='#DDD' fill='#d4c0b3' stroke-width='5' />
                  <path id="path1" d='M10 37 a20 20 0 1 1 24 0'  stroke='#6a6059' fill='none' stroke-width='4' stroke-dasharray='0 100' />
                  <!-- '25 100' /> -->
                  <path d='M10 37 a20 20 0 1 1 24 0'  stroke='#EEE' fill='none' stroke-width='5' stroke-dasharray='0.5 9.5' /> 
                  <!-- //document.getElementById("demo").innerHTML = dd[3]('\n'); -->
                  <text id="text1" x='22' y='22' fill='#FFF' text-anchor='middle' alignment-baseline='middle' style='font: bold 8px 微軟正黑體 Arial'>    ℃</text>
                  </svg>
                </div>
              </div>
              <div class="tr">
                <div class="td">濕度</div>
                <div class="td">
                  <svg xmlns='http://www.w3.org/2000/svg' viewBox='-2 -2 50 42' width='150' >
                    <path d='M10 37 a20 20 0 1 1 24 0'  stroke='#DDD' fill='#d4c0b3' stroke-width='5' />
                    <path id="path2" d='M10 37 a20 20 0 1 1 24 0'  stroke='#6a6059' fill='none' stroke-width='4' stroke-dasharray='0 100' />
                    <path d='M10 37 a20 20 0 1 1 24 0'  stroke='#EEE' fill='none' stroke-width='5' stroke-dasharray='0.5 9.5' />
                    <text id="text2" x='22' y='22' fill='#FFF' text-anchor='middle' alignment-baseline='middle' style='font: bold 8px 微軟正黑體 Arial'>   %</text>
                  </svg>
                </div>
              </div>
              <div class="tr">
                <div class="td">空氣品質</div>
                <div class="td">
                  <svg xmlns='http://www.w3.org/2000/svg' viewBox='-2 -2 50 42' width='150' >
                    <path d='M10 37 a20 20 0 1 1 24 0'  stroke='#DDD' fill='#d4c0b3' stroke-width='5' />
                    <path id="path3" d='M10 37 a20 20 0 1 1 24 0'  stroke='#6a6059' fill='none' stroke-width='4' stroke-dasharray='1.4 100' />
                    <path d='M10 37 a20 20 0 1 1 24 0'  stroke='#FFF' fill='none' stroke-width='5' stroke-dasharray='0.2 0.5' />
                    <text id="text3" x='22' y='22' fill='#FFF' text-anchor='middle' alignment-baseline='middle' style='font: bold 8px 微軟正黑體 Arial'>   ppm</text>
                  </svg>
                </div>
              </div>
            </div>
          </div>
        </section>

        <div id="right_part" class="col-lg-6 col-md-6 col-sm-12 col-xs-12">
          <nav>
            <form id="droplist"> 
                <label for="sensor">歷史數據 : </label>
                <select id="sensor" name="sensor">
                    <option value="angel">Cherry</option>
                    <option value="cherry">LuLu</option>
                    <option value="sean">Red</option>
                    <option value="lulu">Angel</option>
                    <option value="lulu">Irene</option>
                </select>
            </form>
            <script>

                function car_sel(ev) {
                    evt =ev
                    console.log(ev.target.value);
                    LoadDoc();

                }
                sensor.onchange = car_sel
                
            </script>
          </nav>
          <aside>                 
            <script>
            function LoadDoc() {
                var xhttp = new XMLHttpRequest();
                xhttp.onreadystatechange = function() {
                  if (this.readyState == 4 && this.status == 200) {
                    ds = this.responseText.split(",");
                    //ds[0];
                    ds[0].split(" ");
                    n=10;
                    dd = ds.slice(n,n+30);
                    
                    ee=dd.map(x=>x.split(" "))
                    ff = ee.map(x=>[x[3], x[4], x[5]]);
                    gg = ff.map(x=>x.join('\t'))
                    hh = gg.map(x=>x.split('\t')[0])
                   
                    sp = hh[0].slice(5)
                    ii = hh.map(x=>x.split(sp)[0])
                    ii= ii.map(x=>(x.split(sp)[0]-20)*10)
                    ar = []
                    ii.forEach((y, x)=>ar.push(`${x*11},${y}`))
              
                    draw1.setAttribute("points",  ar.join(" "));
              
              
                    // document.getElementById("demo").innerHTML = gg.join('\n');  //顯示歷史數值
                  }    
                };
                xhttp.open("GET", "http://192.168.43.211/cherry.php", true);
                //xhttp.setRequestHeader( "Access-Control-Allow-Origin" ,"*" );
                xhttp.send();
              }
            </script>
            <div id="css-table" class="css-table">
                <div class="tbody">
                  <div class="tr">
                    <div class="td">溫度 (℃)</div>
                  </div>
                  <div class="tr2">
                    <div class="td">  
                    <p id="msg">msg</p>    
                    <svg preserveAspectRatio="xMinYMin" width="330px" viewbox="0,0,330,110" >
                      <rect rx=0 width=330px height=170px fill='#bcab9f' stroke='#FFF' stroke />
                      <path d="M0 0 v200"stroke='#000000'  stroke-dasharray="1 22" stroke-width="5"/>
                      <text x="5" y="27" transform="translate(0,0)">40
                      <tspan x="5" dy="23">30</tspan>
                      <tspan x="5" dy="23">20</tspan>
                      <tspan x="5" dy="23">10</tspan>
                      </text>
                      <path id='vl' d="M50 0 v200"stroke='#FFFFFF'/>
                      <polyline id="draw1" points="60, 110 65, 120" fill="none" stroke="#333" stroke-width="2"/>
                    </svg>
                    <script>
                     function move(ev) {
                       msg.innerText ="x:"+ ev.offsetX + ',' + "y:"+ ev.offsetX
                       var d = `M${ev.offsetX} 0 v200`
                       vl.setAttribute('d', d)
                       evt=ev
                     }
                       // cs = document.querySelectorAll('circle')
                       rt = document.querySelector('rect')
                       rt.onmousemove = move
                       cs.forEach(x=> x.onmouseenter=entry)``
                       msg.innerText = cs[0].getAttribute('cx')
                       function entry(ev) {
                         var x = this.getAttribute('cx')
                         var y = this.getAttribute('cy')
                         msg.innerText = `x:${x} y:${y}`
                         evt = ev
                       }
                     </script>
                    </div>
                  </div>
                  <div class="tr">
                    <div class="td">濕度 (%)</div>
                  </div>
                  <div class="tr2">
                    <div class="td">  
                    <p id="msg2">msg2</p>    
                    <svg preserveAspectRatio="xMinYMin" width="330px" viewbox="0,0,330,110" >
                      <rect id="rect2" rx=0 width=330px height=170px fill='#bcab9f' stroke='#FFF' stroke />
                      <path d="M0 0 v200"stroke='#000000'  stroke-dasharray="1 13" stroke-width="5"/>
                      <text x="5" y="18" transform="translate(0,0)">90
                      <tspan x="5" dy="14">&nbsp</tspan>
                      <tspan x="5" dy="14">70</tspan>
                      <tspan x="5" dy="14">&nbsp</tspan>
                      <tspan x="5" dy="14">50</tspan>
                      <tspan x="5" dy="14">&nbsp</tspan>
                      <tspan x="5" dy="14">30</tspan>
                      <!-- <tspan x="5" dy="11">20%</tspan> -->
                      </text>
                      <path id='vl2' d="M50 0 v200"stroke='#FFFFFF'/>
                      <polyline id="draw1" points="60, 110 65, 120" fill="none" stroke="#333" stroke-width="2"/>
                    </svg>
                    <script>
                     function move(ev2) {
                       msg2.innerText ="x:"+ ev2.offsetX + ',' + "y:"+ ev2.offsetX
                       var d2 = `M${ev2.offsetX} 0 v200`
                       vl2.setAttribute('d', d2)
                       evt2=ev2
                     }
                       // cs = document.querySelectorAll('circle')
                       rt2 = document.querySelector('#rect2')
                       rt2.onmousemove = move
                       // cs.forEach(x=> x.onmouseenter=entry)
                       // msg.innerText = cs[0].getAttribute('cx')
                       function entry(ev2) {
                         var x = this.getAttribute('cx')
                         var y = this.getAttribute('cy')
                         msg2.innerText = `x:${x} y:${y}`
                         evt2 = ev2
                       }
                     </script>
                    </div>
                  </div>
                  <div class="tr">
                    <div class="td">空氣品質 (ppm)</div>
                  </div>
                  <div class="tr2">
                    <div class="td">  
                    <p id="msg3">msg3</p>    
                    <svg preserveAspectRatio="xMinYMin" width="330px" viewbox="0,0,330,160" >
                      <rect id="rect3" rx=0 width=330px height=200px fill='#bcab9f' stroke='#FFF' stroke />
                      <path d="M0 0 v200"stroke='#000000'  stroke-dasharray="1 15" stroke-width="5"/>
                      <text x="5" y="20" transform="translate(0,0)">900
                      <tspan x="5" dy="16">&nbsp</tspan>
                      <tspan x="5" dy="16">700</tspan>
                      <tspan x="5" dy="16">&nbsp</tspan>
                      <tspan x="5" dy="16">500</tspan>
                      <tspan x="5" dy="16">&nbsp</tspan>
                      <tspan x="5" dy="16">300</tspan>
                      <tspan x="5" dy="16">&nbsp</tspan>
                      <tspan x="5" dy="16">100</tspan>
                      <!-- <tspan x="5" dy="11">20%</tspan> -->
                      </text>
                      <path id='vl3' d="M50 0 v200"stroke='#FFFFFF'/>
                      <polyline id="draw1" points="60, 110 65, 120" fill="none" stroke="#333" stroke-width="2"/>
                    </svg>
                    <script>
                     function move(ev3) {
                       msg3.innerText ="x:"+ ev3.offsetX + ',' + "y:"+ ev3.offsetX
                       var d3 = `M${ev3.offsetX} 0 v200`
                       vl3.setAttribute('d', d3)
                       evt3=ev3
                     }
                       // cs = document.querySelectorAll('circle')
                       rt3 = document.querySelector('#rect3')
                       rt3.onmousemove = move
                       // cs.forEach(x=> x.onmouseenter=entry)
                       // msg.innerText = cs[0].getAttribute('cx')
                       function entry(ev3) {
                         var x = this.getAttribute('cx')
                         var y = this.getAttribute('cy')
                         msg3.innerText = `x:${x} y:${y}`
                         evt3 = ev3
                       }
                     </script>
                    </div>
                  </div>
                </div>
              </div>
          </aside>
        </div>

        <footer>© Copyright</footer>
      </div>
    </div>

    <script src="https://cdn.jsdelivr.net/npm/@popperjs/core@2.5.4/dist/umd/popper.min.js" integrity="sha384-q2kxQ16AaE6UbzuKqyBE9/u/KzioAlnx2maXQHiDX9d4/zp8Ok3f+M7DPm+Ib6IU" crossorigin="anonymous"></script>
    <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.0.0-beta1/dist/js/bootstrap.min.js" integrity="sha384-pQQkAEnwaBkjpqZ8RU1fF1AKtTcHJwFl3pblpTlHXybJjHpMYo79HY3hIi4NKxyj" crossorigin="anonymous"></script>
  </body>
</html>